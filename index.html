<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
        rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Roboto", sans-serif;
            overflow-x: hidden;
        }

        html,
        body {
            overflow-x: hidden;
            width: 100vw;
            height: 100vh;
        }

        body {
            color: var(--tg-theme-text-color);
            background: var(--tg-theme-bg-color);
        }

        .Main {
            width: 100%;
            padding: 25px;
            text-align: center;

        }

        .title {
            display: block;
            margin: 16px auto;
            font-size: 1.3em;
            font-weight: 700;
        }

        .description {
            display: block;
            margin: 16px auto;
            font-size: 1em;
            font-weight: 300;
            text-align: justify;
        }

        .emoji {
            display: block;
            width: 128px;
            height: 128px;
            margin: 16px auto;
        }

        .btn {
            border: 0;
            border-radius: 999px;
            height: 36px;
            width: 100%;
            font-size: 0.9em;
            font-weight: 500;
            cursor: pointer;
            color: var(--tg-theme-button-text-color);
            background: var(--tg-theme-button-color);
        }

        .master-list {
            display: flex;
            flex-direction: column;
            row-gap: 25px;
            margin: 25px 0;
            overflow-x: visible;
        }

        .master {
            display: flex;
            flex-direction: column;
            align-content: center;
            align-items: center;
            column-gap: 32px;
            border-radius: 16px;
            padding: 16px;
            -webkit-box-shadow: rgba(0, 0, 0, 0.3) 0 1px 3px;
            -moz-box-shadow: rgba(0, 0, 0, 0.3) 0 1px 3px;
            box-shadow: rgba(0, 0, 0, 0.3) 0 1px 3px;
        }

        .master .emoji {
            width: 80px;
            height: auto;
            margin: 0;
            margin-right: 16px;
        }

        .master-info {
            display: flex;
            flex-direction: column;
            row-gap: 12px;
            text-align: left;
            align-content: center;
            width: -webkit-fill-available;
        }

        .master-info .row {
            display: flex;
            flex-direction: row;
            row-gap: 12px;
            text-align: left;
            align-content: center;
            align-items: center;
            width: -webkit-fill-available;
        }

        .master-info .row .info-row {
            display: flex;
            flex-direction: column;
            row-gap: 12px;
            text-align: left;
            align-content: center;
            width: -webkit-fill-available;
            margin-bottom: 12px;
        }

        .master-info .name {
            font-size: 1.2em;
            font-weight: 700;
        }

        .master-info .functions {
            font-size: 0.9em;
            font-weight: 300;
        }

        .master-info .is-available {
            font-size: 0.9em;
            font-weight: 300;
        }

        .master-info .btn {
            width: 100%;
            height: 36px;
            border-radius: 999px;
        }

        .master-info .disabled {
            width: 100%;
            height: 36px;
            border-radius: 999px;
            cursor: not-allowed;
            pointer-events: none;
            color: #c0c0c0;
            background-color: #ffffff;
        }

        .calendar-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
        }

        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 40px);
            gap: 8px;
            text-align: center;
        }

        .calendar-header {
            display: flex;
            align-content: center;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 328px;
        }

        .time-container,
        .selected-time-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .day,
        .day-label {
            padding: 10px;
            cursor: pointer;
            border-radius: 999px;
            transition: background-color 0.3s;
        }

        .day-label {
            font-weight: bold;
            cursor: default;
        }

        .day:hover,
        .time-slot:hover {
            background-color: #f0f0f0;
        }

        .day.selected,
        .time-slot.selected {
            background-color: #4CAF50;
            color: white;
        }

        .disabled {
            color: #ccc;
            pointer-events: none;
        }

        .other-month {
            color: #aaa;
            pointer-events: none;
        }

        .calendar-header button {
            width: 32px;
            height: 32px;
            background-color: white;
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .calendar-header button img {
            width: 24px;
            height: 24px;
        }

        .selected-date-container,
        .selected-time-container {
            display: none;
            flex-direction: row;
            column-gap: 16px;
            align-content: center;
            justify-content: space-between;
            align-items: center;
            margin-top: 16px;
            padding-bottom: 16px;
        }

        .selected-date-container {
            border-bottom: 1px solid #f0f0f0;
        }

        .selected-date-container button,
        .selected-time-container button {
            width: auto;
            height: 43px;
            background-color: white;
            border-radius: 999px;
            border: none;
            cursor: pointer;
            font-size: 0.9em;
        }

        .selected-date,
        .selected-time {
            /* background-color: #f0f0f0; */
            padding: 12px 16px;
            border-radius: 999px;
            padding-left: 0 !important;
        }

        #date-title,
        #time-title,
        #services-title {
            text-align: left;
            margin-top: 32px;
        }

        .time-slots {
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            gap: 16px;
            margin: 0 auto;
            justify-content: flex-start;
            margin-top: 32px;
        }

        .time-slot {
            padding: 12px 16px;
            cursor: pointer;
            border-radius: 999px;
        }

        .services {
            display: flex;
            flex-direction: column;
            row-gap: 24px;
            margin-bottom: 32px;
        }

        .services label {
            display: flex;
            flex-direction: row;
            height: 32px;
            align-content: center;
            align-items: center;
            justify-content: flex-start;
            font-size: 1em;
            column-gap: 24px;
        }

        .services input {
            width: 24px;
            height: 24px;
            border-radius: 999px;
        }

        .fixed-bottom-btn {
            position: sticky;
            margin-top: auto;
            bottom: 25px;
            /* left: 0; */
            width: 100%;
            height: 48px;
            /* Высота кнопки */
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--tg-theme-button-color);
            color: var(--tg-theme-button-text-color);
            font-weight: 500;
            font-size: 1em;
            cursor: pointer;
            border: none;
            border-radius: 16px;
            z-index: 10;
        }

        .page-content {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            padding-bottom: 25px;
            /* Оставляем место для кнопки */
        }

        .page {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            transform: translateX(100%);
            transition: opacity 0.5s ease, transform 0.5s ease;
            padding: 25px;
        }

        .page.active {
            display: block;
            opacity: 1;
            transform: translateX(0);
        }

        /* Анимация перехода справа налево */
        .page.slide-in-from-right {
            transform: translateX(100%);
        }

        .page.slide-out-to-left {
            transform: translateX(-100%);
        }

        /* Анимация перехода слева направо */
        .page.slide-in-from-left {
            transform: translateX(-100%);
        }

        .page.slide-out-to-right {
            transform: translateX(100%);
        }

        .first-row {
            display: inline-flex;
            width: 100%;
            flex-wrap: nowrap;
            align-content: center;
            justify-content: space-between;
            align-items: center;
        }

        .first-row button {
            width: 32px;
            height: 32px;
            background-color: white;
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .first-row button img {
            width: 32px;
            height: 32px;
        }
    </style>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>

<body>
    <div class="Main">
        <div class="null page active">
            <div class="page-content">
                <span class="title">Активные записи</span>
                <span class="description" style="text-align: center;">Нет активных записей</span>
            </div>
            <button class="btn n-btn fixed-bottom-btn" style="background: #2a9d8f; color: #ffffff;">Записаться</button>
        </div>
        <div class="first page">
            <div class="page-content">
                <img class="emoji" src="static/nails.webp">
                <span class="title">Записываемся на ноготочки!</span>
                <span class="description">Подарите себе красивый маникюр и безупречный уход за ногтями! Мы предлагаем
                    самые
                    лучшие техники и материалы, чтобы ваши ногти всегда выглядели потрясающе.<br><br>Выберите услугу,
                    удобное
                    время, и наши мастера с радостью воплотят ваши идеи в жизнь.</span>
            </div>
            <button class="btn f-btn fixed-bottom-btn">Далее</button>
        </div>
        <div class="second page">
            <span class="title">Выберите специалиста</span>
            <span class="description">Каждый из наших мастеров обладает высоким профессионализмом и вниманием к деталям,
                чтобы сделать ваш визит максимально комфортным и результативным.</span>
            <div class="master-list">
                <div class="master">
                    <div class="master-info">
                        <div class="row">
                            <img class="emoji" src="static/seal.webp">
                            <div class="info-row">
                                <span class="name">Мастер 1</span>
                                <span class="functions">классический маникюр, французский маникюр</span>
                                <span class="is-available">Ближайшая запись: послезавтра</span>
                            </div>
                        </div>
                        <button class="btn s-btn">Выбрать специалиста</button>
                    </div>
                </div>
                <div class="master">
                    <div class="master-info">
                        <div class="row">
                            <img class="emoji" src="static/owl.webp">
                            <div class="info-row">
                                <span class="name">Мастер 2</span>
                                <span class="functions">креативные дизайны, градиент, стразы, наклейки</span>
                                <span class="is-available">Ближайшая запись: 14 октября 2024</span>
                            </div>
                        </div>
                        <button class="btn s-btn">Выбрать специалиста</button>
                    </div>
                </div>
                <div class="master">
                    <div class="master-info">
                        <div class="row">
                            <img class="emoji" src="static/panda.webp">
                            <div class="info-row">
                                <span class="name">Мастер 3</span>
                                <span class="functions">маникюр "по-сочински"</span>
                                <span class="is-available">В отпуске</span>
                            </div>
                        </div>
                        <button class="btn s-btn">Запись недоступна</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="third page">
            <div class="page-content" style="overflow-x: visible;">
                <div class="master">
                    <div class="master-info">
                        <div class="row">
                            <img class="emoji" src="static/seal.webp">
                            <div class="info-row">
                                <span class="name">Мастер 1</span>
                                <span class="functions">классический маникюр, французский маникюр</span>
                            </div>
                        </div>
                    </div>
                </div>
                <span class="title" id="date-title">Дата и время</span>
                <div class="calendar-container" id="calendar-container">
                    <div class="calendar-header">
                        <button onclick="changeMonth(-1)"><img src="static/arrow_back.svg"></button>
                        <span id="calendar-month-year"></span>
                        <button onclick="changeMonth(1)"><img src="static/arrow_forward.svg"></button>
                    </div>
                    <div class="calendar" id="calendar-days"></div>
                </div>
                <div class="selected-date-container" id="selected-date-container">
                    <span class="selected-date" id="selected-date"></span>
                    <button id="showCalendarButton">Изменить</button>
                </div>

                <div class="time-container" id="time-container">
                    <div class="time-slots" id="time-slots">
                        <!-- Временные слоты добавляются здесь программно -->
                    </div>
                </div>

                <div class="selected-time-container" id="selected-time-container">
                    <span class="selected-time" id="selected-time"></span>
                    <button id="showTimeSelectionButton">Изменить</button>
                </div>

                <span class="title" id="services-title">Услуги</span>
                <div class="services">
                    <label>
                        <input type="checkbox"> Классический маникюр
                    </label>
                    <label>
                        <input type="checkbox"> Французский маникюр
                    </label>
                </div>
            </div>
            <button class="btn t-btn disabled fixed-bottom-btn" disabled
                style="bottom: 0 !important;">Записаться</button>
        </div>
    </div>


    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Telegram Web App initialization
            let tg = window.Telegram.WebApp;
            tg.expand();

            // Buttons
            const nBtn = document.querySelector(".n-btn");
            const fBtn = document.querySelector(".f-btn");
            const sBtn = document.querySelector(".s-btn");
            const tBtn = document.querySelector(".t-btn");

            const startPage = document.querySelector(".null");
            const firstPage = document.querySelector(".first");
            const secondPage = document.querySelector(".second");
            const thirdPage = document.querySelector(".third");

            function animateTransition(fromPage, toPage) {
                fromPage.classList.add("slide-out-to-left");
                toPage.classList.add("slide-in-from-right", "active");

                // Убираем анимационные классы после окончания анимации
                fromPage.addEventListener("transitionend", function handler() {
                    fromPage.classList.remove("active", "slide-out-to-left");
                    toPage.classList.remove("slide-in-from-right");
                    fromPage.removeEventListener("transitionend", handler);
                });
            }

            nBtn.addEventListener("click", () => {
                animateTransition(startPage, firstPage);
            });

            fBtn.addEventListener("click", () => {
                animateTransition(firstPage, secondPage);
            });

            sBtn.addEventListener("click", () => {
                animateTransition(secondPage, thirdPage);
            });

            tBtn.addEventListener("click", () => {
                tg.close();
            });

            // Calendar and time selection elements
            const calendarDays = document.getElementById("calendar-days");
            const calendarMonthYear = document.getElementById("calendar-month-year");
            const calendarContainer = document.getElementById("calendar-container");
            const selectedDateContainer = document.getElementById("selected-date-container");
            const selectedDateText = document.getElementById("selected-date");

            const timeContainer = document.getElementById("time-container");
            const selectedTimeContainer = document.getElementById("selected-time-container");
            const selectedTimeText = document.getElementById("selected-time");

            const timeSlotsContainer = document.getElementById("time-slots");
            const serviceCheckboxes = document.querySelectorAll(".services input[type='checkbox']");

            // Available dates and times
            const availableDates = [
                "2024-10-14", "2024-10-16", "2024-10-18",
                "2024-10-21", "2024-10-23", "2024-10-25",
                "2024-10-28", "2024-10-30", "2024-11-01"
            ];
            const availableTimes = ["10:00", "12:00", "14:00", "16:00"];

            let selectedDate = null;
            let selectedTime = null;
            let currentMonth = new Date().getMonth();
            let currentYear = new Date().getFullYear();
            const dayLabels = ["Пн", "Вт", "Ср", "Чт", "Пт", "Сб", "Вс"];

            // Render calendar function
            function renderCalendar(month, year) {
                calendarDays.innerHTML = "";
                calendarMonthYear.textContent = new Date(year, month).toLocaleString('ru', { month: 'long', year: 'numeric' }).replace(' г.', '');

                dayLabels.forEach(label => {
                    const dayLabel = document.createElement("div");
                    dayLabel.classList.add("day-label");
                    dayLabel.textContent = label;
                    calendarDays.appendChild(dayLabel);
                });

                const firstDayOfMonth = new Date(year, month, 1).getDay();
                const daysInMonth = new Date(year, month + 1, 0).getDate();
                const prevDaysInMonth = new Date(year, month, 0).getDate();
                const startDay = (firstDayOfMonth + 6) % 7;

                for (let i = startDay - 1; i >= 0; i--) {
                    const dayCell = document.createElement("div");
                    dayCell.classList.add("day", "other-month");
                    dayCell.textContent = prevDaysInMonth - i;
                    calendarDays.appendChild(dayCell);
                }

                for (let day = 1; day <= daysInMonth; day++) {
                    const dayCell = document.createElement("div");
                    dayCell.classList.add("day");
                    dayCell.textContent = day;

                    const dateString = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                    if (availableDates.includes(dateString)) {
                        dayCell.addEventListener("click", () => selectDate(day, month, year));
                    } else {
                        dayCell.classList.add("disabled");
                    }
                    calendarDays.appendChild(dayCell);

                    if (selectedDate && selectedDate.getDate() === day && selectedDate.getMonth() === month && selectedDate.getFullYear() === year) {
                        dayCell.classList.add("selected");
                    }
                }

                const totalCells = startDay + daysInMonth;
                const nextMonthDays = 7 - (totalCells % 7);
                if (nextMonthDays < 7) {
                    for (let i = 1; i <= nextMonthDays; i++) {
                        const dayCell = document.createElement("div");
                        dayCell.classList.add("day", "other-month");
                        dayCell.textContent = i;
                        calendarDays.appendChild(dayCell);
                    }
                }
            }

            // Date selection
            function selectDate(day, month, year) {
                selectedDate = new Date(year, month, day);
                selectedDateText.textContent = selectedDate.toLocaleDateString('ru', { day: 'numeric', month: 'long', year: 'numeric' }).replace(' г.', '');
                toggleCalendarDisplay(false);
                renderTimeSlots();
                updateSubmitButtonState();
            }

            function toggleCalendarDisplay(showCalendar) {
                calendarContainer.style.display = showCalendar ? 'flex' : 'none';
                selectedDateContainer.style.display = showCalendar ? 'none' : 'flex';
            }

            function changeMonth(step) {
                currentMonth += step;
                if (currentMonth < 0) {
                    currentMonth = 11;
                    currentYear -= 1;
                } else if (currentMonth > 11) {
                    currentMonth = 0;
                    currentYear += 1;
                }
                renderCalendar(currentMonth, currentYear);
            }

            function showCalendar() {
                toggleCalendarDisplay(true);
                timeContainer.style.display = "none";
                selectedTimeContainer.style.display = "none";
            }

            // Render time slots
            function renderTimeSlots() {
                timeSlotsContainer.innerHTML = '';
                availableTimes.forEach(time => {
                    const timeSlot = document.createElement("div");
                    timeSlot.classList.add("time-slot");
                    timeSlot.textContent = time;
                    timeSlot.addEventListener("click", () => selectTime(time));
                    timeSlotsContainer.appendChild(timeSlot);
                });
                timeContainer.style.display = "flex";
            }

            // Time selection
            function selectTime(time) {
                selectedTime = time;
                selectedTimeText.textContent = time;
                toggleTimeDisplay(false);
                updateSubmitButtonState();
            }

            function toggleTimeDisplay(showTimeSelection) {
                timeContainer.style.display = showTimeSelection ? "flex" : "none";
                selectedTimeContainer.style.display = showTimeSelection ? "none" : "flex";
            }

            function showTimeSelection() {
                toggleTimeDisplay(true);
            }

            showCalendarButton.addEventListener("click", showCalendar);
            showTimeSelectionButton.addEventListener("click", showTimeSelection);

            function updateSubmitButtonState() {
                const isServiceSelected = Array.from(serviceCheckboxes).some(checkbox => checkbox.checked);
                if (selectedDate && selectedTime && isServiceSelected) {
                    tBtn.classList.remove("disabled");
                    tBtn.disabled = false;
                    tBtn.style.cursor = "pointer";
                    tBtn.style.opacity = "1";
                } else {
                    tBtn.classList.add("disabled");
                    tBtn.disabled = true;
                    tBtn.style.cursor = "not-allowed";
                    tBtn.style.opacity = "0.6";
                }
            }

            serviceCheckboxes.forEach(checkbox => {
                checkbox.addEventListener("change", updateSubmitButtonState);
            });

            renderCalendar(currentMonth, currentYear);
            updateSubmitButtonState();
        });
    </script>

</body>

</html>